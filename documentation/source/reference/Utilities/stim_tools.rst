Stim Tools
==========

Stim is a fast simulator for Clifford circuits. It is capable of simulating circuits with thousands of qubits and millions of operations in seconds. This performance is achieved by restricting the allowed gates to the Clifford group. This group is generated by the Hadamard gate, the Phase gate, and the CNOT gate. While this set of gates is not universal, it is sufficient to simulate a wide range of quantum error correction protocols.

Stim is designed to simulate noisy quantum circuits. It allows to insert Pauli noise into the circuit simulation, which is a good approximation for many physical noise sources. Qrisp provides an interface to Stim, that allows to convert Qrisp circuits to Stim circuits.

Constructing Stim Circuits with Qrisp
-------------------------------------

In order to leverage Stim's high performance compilation pipeline, Qrisp offers two ways to directly construct Stim circuits from your Qrisp code.

.. list-table::
   :header-rows: 0
   :widths: 30 70

   * - :meth:`~qrisp.QuantumCircuit.to_stim`
     - Method to convert the given QuantumCircuit to a `Stim <https://github.com/quantumlib/Stim/>`_ Circuit.
   * - :func:`~qrisp.jasp.extract_stim`
     - Decorator that extracts a Stim circuit from a Jasp-traceable function.

.. toctree:: 
   :hidden:

   extract_stim_doc




Inserting Noise
---------------

A crucial feature of Stim is precise control over what type of noise can appear during the circuit execution and a very powerful simulation pipeline. In order to describe this Qrisp offers two options for realizing arbitrary noise channels.

.. list-table::
   :header-rows: 0
   :widths: 30 70

   * - :func:`~qrisp.misc.stim_tools.stim_noise`
     - Applies a Stim error gate to the given qubits.
   * - :class:`~qrisp.misc.stim_tools.StimNoiseGate`
     - Class for representing Stim errors in Qrisp circuits.
   * - :func:`~qrisp.misc.stim_tools.permute_detectors`
     - Permutes the detectors in a Stim circuit according to the given permutation.

.. toctree:: 
   :hidden:

   stim_noise_doc
   StimNoiseGate_doc
   permute_detectors_doc

.. warning::

    Every noisy operation described here behaves as a purely unitary identity gate, unless the compilation target is indeed Stim (see :meth:`~qrisp.QuantumCircuit.to_stim`). This means for instance that :meth:`~qrisp.QuantumCircuit.to_qiskit` converts the noisy operations to trivial identity gates. The same applies to the behavior of the Qrisp simulator. In other words - the noisy operations will only behave noisy if pushed through the Stim compiler.

Detectors and Observables
-------------------------

In Stim, detectors are annotations asserting that a set of measurement outcomes has a deterministic parity. Observables are similar structures tracking logical information.
Qrisp allows you to define these structures using the general-purpose :func:`~qrisp.parity` function.

.. list-table::
   :header-rows: 0
   :widths: 30 70

   * - :func:`~qrisp.parity`
     - Performs a parity check on measurement results. Creates Stim detectors or observables when used within :func:`~qrisp.jasp.extract_stim`.

.. toctree:: 
   :hidden:

   parity_doc
